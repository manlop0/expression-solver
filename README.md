# Expression solver


## Структура приложения

![alt text](https://github.com/manlop0/expression-solver/blob/main/appStruct.drawio.svg)

Приложение докеризировано и состоит из 5 контейнеров:
### 1. frontend
   фронтенд, написанный на nextjs
### 3. orchestrator 
   сервер, принимающий запросы пользователя и отвечающий на них. Все данные берет из базы данных
### 4. agent 
   программа, которая просматривает очередь на выражения, берет их оттуда и отдает свободному вычислителю (горутине, которая работает в этом же контейнере параллельно агенту).
   Вычислитель принимает выражение и решает его последовательно, а результат вычисления отправляет в базу данных.
   Состояние каждого вычислителя изменяется в базе данных и отображается на сайте.
   Количество вычислителей регулируется переменной окружения `NUM_OF_WORKERS` контейнера `agent` в `compose.yaml` файле.
### 5. db 
  база данных postgresql
### 6. redis 
  база данных redis, которая используется для создания очереди выражений


## Начало работы
Необходимые программы на компьютере для запуска приложения: `Docker, Nodejs, Go`

Чтобы запустить программу, в терминале пропишите команду `docker compose build` для создания образов, а после `docker compose up -d` для запуска контейнеров.
Далее перейдите по адресу `http://localhost:3000/` - на нем запущено наше приложение.

1. Во вкладке `Expression List` отображается список выражений и поле для написания выражений. Аримфетические выражения могут включать операции `+ - * /`, `( )`, а также `отрицательные числа`.
2. В `Operations settings` можно выставить время выполнения каждой операции (в секундах).
3. Вкладка `Computers List` отобрабает список вычислителей: состояние вычислителя и выражение, над которым он работает.
   В случае когда все вычислители заняты, добавленное выражение будет ожидать в очереди, и даже если приложение завершит работу, они не удалятся.


## Завершение работы
Чтобы полностью остановить приложение, можно зайти в `Docker Desktop` и остановить и удалить контейнеры оттуда (а также удалить images и volumes), либо прописать в консоли эти команды:
`docker stop $(docker ps -qa)`
`docker rm $(docker ps -qa)`
`docker rmi -f $(docker images -qa)`
`docker volume rm $(docker volume ls -q)`
`docker network rm $(docker network ls -q)`


## Примечание
На сайте нет динамического обновления, поэтому если решаемое выражение уже получило ответ, то для его отображения необходимо `перезагрузить страницу` или `переоткрыть вкладку` с выражениями!
